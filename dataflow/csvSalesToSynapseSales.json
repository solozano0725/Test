{
	"name": "csvSalesToSynapseSales",
	"properties": {
		"folder": {
			"name": "reverse_logistics/RTI/data_cleaning/catalog"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "csv_sales",
						"type": "DatasetReference"
					},
					"name": "SourceCSVSales"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "synpsql_sales",
						"type": "DatasetReference"
					},
					"name": "DestinationSynapseTableSales"
				}
			],
			"transformations": [
				{
					"name": "FilterByTipoAndSegmAndSector"
				},
				{
					"name": "SelectColumns"
				},
				{
					"name": "SortRows"
				}
			],
			"script": "source(output(\n\t\tTipo1 as string,\n\t\tTipo2 as string,\n\t\tTipo as string,\n\t\tDrv_Act as string,\n\t\tCOD_UEN as string,\n\t\tUEN as string,\n\t\tSAG as string,\n\t\tCOD_SAG as string,\n\t\tMaterial as string,\n\t\tDes_Mat as string,\n\t\tMarca as string,\n\t\tCupo as string,\n\t\tSegmento as string,\n\t\tSector as string,\n\t\tInnovacion as string,\n\t\tClasificacion as string,\n\t\tBeerhouse as string,\n\t\tSubCupo as string,\n\t\tOnzas as string,\n\t\tPackPresentacion as string,\n\t\tFamilia as string,\n\t\t{High End} as string,\n\t\tOrigen as string,\n\t\tAbr_19 as string,\n\t\tMay_19 as string,\n\t\tEne_20 as string,\n\t\tFeb_20 as string,\n\t\tMar_20 as string,\n\t\tAbr_20 as string,\n\t\tMay_20 as string,\n\t\tJun_20 as string,\n\t\tJul_20 as string,\n\t\tAgo_20 as string,\n\t\tSep_20 as string,\n\t\tOct_20 as string,\n\t\tNov_20 as string,\n\t\tDic_20 as string,\n\t\tEne_21 as string,\n\t\tFeb_21 as string,\n\t\tMar_21 as string,\n\t\tAbr_21 as string,\n\t\tMay_21 as string,\n\t\tJun_21 as string,\n\t\tJul_21 as string,\n\t\tAgo_21 as string,\n\t\tSep_21 as string,\n\t\tOct_21 as string,\n\t\tNov_21 as string,\n\t\tDic_21 as string,\n\t\tAcumDia_19 as string,\n\t\tAcumDia_21 as string,\n\t\tMTD_19 as string,\n\t\tTend as string,\n\t\tYTD_19 as string,\n\t\tYTD_21 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> SourceCSVSales\nSourceCSVSales filter(( equalsIgnoreCase(trim(Tipo), \"Concesionarios\") || equalsIgnoreCase(trim(Tipo), \"Directas\") ) && ( equalsIgnoreCase(trim(Segmento), \"Retornable\") ) && ( equalsIgnoreCase(trim(Sector), \"Cerveza\") )) ~> FilterByTipoAndSegmAndSector\nFilterByTipoAndSegmAndSector select(mapColumn(\n\t\teach(match(true()))\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectColumns\nSelectColumns sort(asc(COD_SAG, true),\n\tasc(SAG, true),\n\tasc(Material, true),\n\tasc(Des_Mat, true)) ~> SortRows\nSortRows sink(input(\n\t\tTipo1 as string,\n\t\tTipo2 as string,\n\t\tTipo as string,\n\t\tDrv_Act as string,\n\t\tCOD_UEN as string,\n\t\tUEN as string,\n\t\tSAG as string,\n\t\tCOD_SAG as string,\n\t\tMaterial as string,\n\t\tDes_Mat as string,\n\t\tMarca as string,\n\t\tCupo as string,\n\t\tSegmento as string,\n\t\tSector as string,\n\t\tInnovacion as string,\n\t\tClasificacion as string,\n\t\tBeerhouse as string,\n\t\tSubCupo as string,\n\t\tOnzas as string,\n\t\tPackPresentacion as string,\n\t\tFamilia as string,\n\t\tHigh_End as string,\n\t\tOrigen as string,\n\t\tAbr_19 as string,\n\t\tMay_19 as string,\n\t\tEne_20 as string,\n\t\tFeb_20 as string,\n\t\tMar_20 as string,\n\t\tAbr_20 as string,\n\t\tMay_20 as string,\n\t\tJun_20 as string,\n\t\tJul_20 as string,\n\t\tAgo_20 as string,\n\t\tSep_20 as string,\n\t\tOct_20 as string,\n\t\tNov_20 as string,\n\t\tDic_20 as string,\n\t\tEne_21 as string,\n\t\tFeb_21 as string,\n\t\tMar_21 as string,\n\t\tAbr_21 as string,\n\t\tMay_21 as string,\n\t\tJun_21 as string,\n\t\tJul_21 as string,\n\t\tAgo_21 as string,\n\t\tSep_21 as string,\n\t\tOct_21 as string,\n\t\tNov_21 as string,\n\t\tDic_21 as string,\n\t\tAcumDia_19 as string,\n\t\tAcumDia_21 as string,\n\t\tMTD_19 as string,\n\t\tTend as string,\n\t\tYTD_19 as string,\n\t\tYTD_21 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tstaged: true,\n\tallowCopyCommand: true,\n\tmapColumn(\n\t\tTipo1,\n\t\tTipo2,\n\t\tTipo,\n\t\tDrv_Act,\n\t\tCOD_UEN,\n\t\tUEN,\n\t\tSAG,\n\t\tCOD_SAG,\n\t\tMaterial,\n\t\tDes_Mat,\n\t\tMarca,\n\t\tCupo,\n\t\tSegmento,\n\t\tSector,\n\t\tInnovacion,\n\t\tClasificacion,\n\t\tBeerhouse,\n\t\tSubCupo,\n\t\tOnzas,\n\t\tPackPresentacion,\n\t\tFamilia,\n\t\tHigh_End = {High End},\n\t\tOrigen,\n\t\tAbr_19,\n\t\tMay_19,\n\t\tEne_20,\n\t\tFeb_20,\n\t\tMar_20,\n\t\tAbr_20,\n\t\tMay_20,\n\t\tJun_20,\n\t\tJul_20,\n\t\tAgo_20,\n\t\tSep_20,\n\t\tOct_20,\n\t\tNov_20,\n\t\tDic_20,\n\t\tEne_21,\n\t\tFeb_21,\n\t\tMar_21,\n\t\tAbr_21,\n\t\tMay_21,\n\t\tJun_21,\n\t\tJul_21,\n\t\tAgo_21,\n\t\tSep_21,\n\t\tOct_21,\n\t\tNov_21,\n\t\tDic_21,\n\t\tAcumDia_19,\n\t\tAcumDia_21,\n\t\tMTD_19,\n\t\tTend,\n\t\tYTD_19,\n\t\tYTD_21\n\t),\n\terrorHandlingOption: 'stopOnFirstError') ~> DestinationSynapseTableSales"
		}
	}
}