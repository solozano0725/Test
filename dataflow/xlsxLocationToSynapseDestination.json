{
	"name": "xlsxLocationToSynapseDestination",
	"properties": {
		"folder": {
			"name": "reverse_logistics/transit/data_cleaning/catalog"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "xlsx_location",
						"type": "DatasetReference"
					},
					"name": "SourceXLSXLocation"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "synapsql_destination",
						"type": "DatasetReference"
					},
					"name": "DestinationSynapseDestination"
				}
			],
			"transformations": [
				{
					"name": "SelectColumns"
				},
				{
					"name": "TrimColumns"
				}
			],
			"script": "source(output(\n\t\ti2 as string,\n\t\t{# Sociedad Nueva} as string,\n\t\t{# Sociedad Anterior} as string,\n\t\t{ID SAG Nueva} as string,\n\t\t{ID SAG Anterior} as string,\n\t\tDRV_Nva as string,\n\t\tDRV as string,\n\t\t{Descripción UEN} as string,\n\t\t{Descripcion UEN Corto} as string,\n\t\t{Descripción SAG} as string,\n\t\tEsquema as string,\n\t\tEstado as string,\n\t\tTipo as string,\n\t\t{Distribución} as string,\n\t\t{Puerto Expedición} as string,\n\t\tZona as string,\n\t\tAgencia as string,\n\t\t{Sub Agencia} as string,\n\t\tTipo_Inv as string,\n\t\tOrigenJDA as string,\n\t\tDestinoJDA as string,\n\t\t{Descripción Destino} as string,\n\t\t{Tipo Distribución} as string,\n\t\tOp as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> SourceXLSXLocation\nTrimColumns select(mapColumn(\n\t\tI2 = i2,\n\t\tNSociedadNueva = {# Sociedad Nueva},\n\t\tNSociedadAnterior = {# Sociedad Anterior},\n\t\tIDSAGNueva = {ID SAG Nueva},\n\t\tIDSAGAnterior = {ID SAG Anterior},\n\t\tDRVNva = DRV_Nva,\n\t\tDRV,\n\t\tDescripcionUEN = {Descripción UEN},\n\t\tDescripcionUENCorto = {Descripcion UEN Corto},\n\t\tDescripcionSAG = {Descripcion UEN Corto},\n\t\tEsquema,\n\t\tEstado,\n\t\tTipo,\n\t\tDistribucion = {Distribución},\n\t\tPuertoExpedicion = {Distribución},\n\t\tZona,\n\t\tAgencia,\n\t\tSubAgencia = {Sub Agencia},\n\t\tTipoInv = Tipo_Inv,\n\t\tOrigenJDA,\n\t\tDestinoJDA,\n\t\tDescripcionDestino = {Descripción Destino},\n\t\t{TipoDistribución} = {Tipo Distribución}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectColumns\nSourceXLSXLocation derive(i2 = trim(i2),\n\t\t{# Sociedad Nueva} = trim({# Sociedad Nueva}),\n\t\t{# Sociedad Anterior} = trim({# Sociedad Anterior}),\n\t\t{ID SAG Nueva} = trim({ID SAG Nueva}),\n\t\t{ID SAG Anterior} = trim({ID SAG Anterior}),\n\t\tDRV_Nva = trim(DRV_Nva),\n\t\tDRV = trim(DRV),\n\t\t{Descripción UEN} = trim({Descripción UEN}),\n\t\t{Descripcion UEN Corto} = trim({Descripcion UEN Corto}),\n\t\t{Descripción SAG} = trim({Descripción SAG}),\n\t\tEsquema = trim(Esquema),\n\t\tEstado = trim(Estado),\n\t\tTipo = trim(Tipo),\n\t\t{Distribución} = trim({Distribución}),\n\t\t{Puerto Expedición} = trim({Puerto Expedición}),\n\t\tZona = trim(Zona),\n\t\tAgencia = trim(Agencia),\n\t\t{Sub Agencia} = trim({Sub Agencia}),\n\t\tTipo_Inv = trim(Tipo_Inv),\n\t\tOrigenJDA = trim(OrigenJDA),\n\t\tDestinoJDA = trim(DestinoJDA),\n\t\t{Tipo Distribución} = trim({Tipo Distribución}),\n\t\tOp = trim(Op)) ~> TrimColumns\nSelectColumns sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tstaged: true,\n\tallowCopyCommand: true,\n\tmapColumn(\n\t\ti2 = I2,\n\t\tNSociedadNueva,\n\t\tNSociedadAnterior,\n\t\tIDSAGNueva,\n\t\tIDSAGAnterior,\n\t\tDRVNva,\n\t\tDRV,\n\t\tDescripcionUEN,\n\t\tDescripcionUENCorto,\n\t\tEsquema,\n\t\tEstado,\n\t\tTipo,\n\t\tDistribucion,\n\t\tZona,\n\t\tAgencia,\n\t\tSubAgencia,\n\t\tTipoInv,\n\t\tOrigenJDA,\n\t\tDestinoJDA,\n\t\tDescripcionDestino,\n\t\t{TipoDistribución}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> DestinationSynapseDestination"
		}
	}
}